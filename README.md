# anno2024

* 安野たかひろ都知事選候補ポスターの貼付マイマップのピンを貼付待ちのものに絞り込む

# 背景

* 2024年初夏に東京都知事選が行われている
* [安野たかひろ](https://github.com/takahiroanno2024)氏が立候補している
* 選挙ポスター貼りなどボランティアを求めている
* 選挙ポスター貼付作業は、事前にボランティア作業に応募し、あらかじめ定められた選挙ポスター貼付板にポスターを貼っていく作業

* ポスターを貼り付けるべき地点は、貼付ボランティアに対し、Googleマップのマイマップで提供されている
* マイマップは「東京都の大まかな地域」→「市区」の階層でレベル分けされている
* マイマップの貼付地点のピンは、「貼付済」「貼付待ち」「その他」といったステータスが色分けされている
* 貼付したことは、専用のLINEチャットで簡潔に報告する
* LINEチャットで報告すると、おそらく自動的にマイマップ上のピンのデータが更新される

# 課題

* このように、選挙ポスター貼付作業の中心的なフローは、外出先で、未貼付の地点ピンを効率よく閲覧し、次の目的地を判断し、必要に応じナビ機能を用いて移動する、ということの繰り返しである
* これらピンはマイマップで提供されている
* マイマップは大まかな地域ごとに分類されており、市区ごとに表示on/offも可能だが、基本的にかなり大量のピンから構成されており、少なくとも私(iPhone 15 + Googleマップアプリ)の場合、拡大するたびにピンが消えてしまうなどの挙動もあり、特に出先では表示や閲覧にかなり難儀する。

# 課題解決(緩和)

* マイマップデータを、これから自分が貼付作業を行う対象の市区のみ、かつ未貼付のピンのみにできれば、データ量が減り、閲覧が楽になる。
* 本リポジトリを用いればこれが可能となる

# 動作環境

- macOS
  - Sonoma 14.5など適切に新しいもの
  - 必要とする以下のコマンド群が動くなら他のOSでも構わない
- [Homebrew](https://brew.sh/ja/)
- [xmlstarlet](https://xmlstar.sourceforge.net/)
- make
- git

# インストール

- [Homebrew](https://brew.sh/ja/)をインストール
- Homebrewを使って[xmlstarlet](https://xmlstar.sourceforge.net/)をインストール
  - `brew install xmlstarlet`
- 必要に応じmakeをインストール
  - Xcodeのコマンドラインツールに含まれている
  - Xcode一式は巨大なので, Homebrewに含まれているmakeのみを `brew install make` でインストールするのでもよいだろう
- 本リポジトリを手元に `git clone` する
- `local.mk.sample` をコピーして `local.mk` ファイルを作る
- `targets.mk.sample` をコピーして `targets.mk` ファイルを作る

# 使い方

- これから自分が貼付作業を行う対象の市区のマイマップデータをダウンロード
  - マイマップのメニュー右にある「縦3点」をクリック
  - 出てくるポップアップから「KMLをダウンロード」を選択
  - プルダウンから「市区名.csv」を選択、「OK」をクリック
- 「市区名.csv.kmz」ファイルがダウンロードされるので、それらを本リポジトリのcloneがあるフォルダに移動
- `targets.mk` ファイルを編集し、処理したい市区名が列記されるよう修正
- `make` を実行
  - すると、未貼付ピンのみ含まれた「市区名.kml」が生成される
  - ピンの総数と未貼付数も表示される
- ブラウザでGoogleマップを開き、マイマップを新規作成
- 新規作成したマイマップ「無題の地図」の「無題のレイヤ」の「インポート」を選び、さきほど作られた「市区名.kml」を指定
- お好みに応じ、マイマップ「無題の地図」の名称を変更

これで、出先でスマホでそのマイマップを開くと、これから向かう市区の、未貼付ピンのみが表示される。

# ライセンス

MIT

